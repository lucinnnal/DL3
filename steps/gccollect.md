# 🧹 Python `gc.collect()` 정리 노트

## ✅ 1. 개요

`gc.collect()`는 **파이썬의 가비지 컬렉터(Garbage Collector)**를 강제로 실행해,  
**순환 참조 등으로 인해 자동으로 메모리에서 해제되지 않는 객체들**을 찾아 제거하는 함수이다.

> 파이썬은 기본적으로 **참조 카운트(reference counting)** 기반의 메모리 관리 방식을 사용하지만,  
> 객체 간에 서로를 참조하는 구조에서는 참조 카운트가 0이 되지 않아 가비지 컬렉터의 개입이 필요하다.

---

## ✅ 2. 사용 목적

- 순환 참조로 인한 메모리 누수 방지
- 더 이상 접근할 수 없는 객체의 수거
- 메모리 사용량 최적화
- 디버깅용 수동 가비지 컬렉션

---

## ✅ 3. 기본 사용법

```python
import gc

unreachable = gc.collect()  # 가비지 컬렉터 실행
print(f"수거된 객체 수: {unreachable}")
```

---

## ✅ 4. 순환 참조 예시

### 📌 순환 참조 구조를 가진 코드 예제

```python
class Node:
    def __init__(self):
        self.ref = None

# 두 객체가 서로를 참조
a = Node()
b = Node()
a.ref = b
b.ref = a

# 사용자 입장에서 더 이상 접근할 수 없음
del a
del b

# 참조 카운트가 0이 아니므로 자동 수거 안 됨
import gc
gc.collect()  # 수동 가비지 컬렉션 실행
```

### 📎 설명
- `a`와 `b`는 서로를 참조하는 구조 (`a.ref = b`, `b.ref = a`)
- `del a`, `del b`로 사용자 코드에서는 더 이상 접근할 수 없음
- 하지만 객체 내부에서는 여전히 참조가 남아 있어 메모리 해제되지 않음
- `gc.collect()`가 이러한 **순환 참조 그래프를 분석**해 제거함

---

## ✅ 5. 유용한 관련 함수

| 함수 | 설명 |
|------|------|
| `gc.collect()` | 수동으로 가비지 컬렉션 실행 |
| `gc.get_objects()` | 현재 추적 중인 모든 객체 반환 |
| `gc.get_referrers(obj)` | 해당 객체를 참조하고 있는 객체들 |
| `gc.get_referents(obj)` | 해당 객체가 참조하고 있는 객체들 |

---

## ✅ 6. 주의사항

- `gc.collect()`는 내부적으로 비용이 큰 연산 → **필요할 때만 호출**
- 대부분의 상황에서는 **파이썬이 자동으로 처리**하므로 수동 호출은 불필요
- 하지만 **순환 참조가 자주 발생하는 구조**에서는 명시적으로 호출하는 것이 좋을 수 있음

---

## ✅ 결론

> `gc.collect()`는 파이썬에서 참조 카운트만으로는 수거되지 않는  
> **순환 참조된 불필요한 객체들을 제거**하기 위해 사용되는 중요한 도구이며,  
> 메모리 누수를 막기 위해 적절한 타이밍에 활용될 수 있다.

## 파이썬에서는 참조카운트가 0이면 메모리 해제가 되는 것임.